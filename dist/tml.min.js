var C=Object.defineProperty;var j=(o,t,s)=>t in o?C(o,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[t]=s;var g=(o,t,s)=>(j(o,typeof t!="symbol"?t+"":t,s),s);var y=function(o,t,s,e){var r;t[0]=0;for(var n=1;n<t.length;n++){var i=t[n++],c=t[n]?(t[0]|=i?1:2,s[t[n++]]):t[++n];i===3?e[0]=c:i===4?e[1]=Object.assign(e[1]||{},c):i===5?(e[1]=e[1]||{})[t[++n]]=c:i===6?e[1][t[++n]]+=c+"":i?(r=o.apply(c,y(o,c,s,["",null])),e.push(r),c[0]?t[0]|=2:(t[n-2]=0,t[n]=r)):e.push(c)}return e},x=new Map;function N(o){var t=x.get(this);return t||(t=new Map,x.set(this,t)),(t=y(this,t.get(o)||(t.set(o,t=function(s){for(var e,r,n=1,i="",c="",a=[0],m=function(u){n===1&&(u||(i=i.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?a.push(0,u,i):n===3&&(u||i)?(a.push(3,u,i),n=2):n===2&&i==="..."&&u?a.push(4,u,0):n===2&&i&&!u?a.push(5,0,!0,i):n>=5&&((i||!u&&n===5)&&(a.push(n,0,i,r),n=6),u&&(a.push(n,u,0,r),n=6)),i=""},f=0;f<s.length;f++){f&&(n===1&&m(),m(f));for(var p=0;p<s[f].length;p++)e=s[f][p],n===1?e==="<"?(m(),a=[a],n=3):i+=e:n===4?i==="--"&&e===">"?(n=1,i=""):i=e+i[0]:c?e===c?c="":i+=e:e==='"'||e==="'"?c=e:e===">"?(m(),n=1):n&&(e==="="?(n=5,r=i,i=""):e==="/"&&(n<5||s[f][p+1]===">")?(m(),n===3&&(a=a[0]),n=a,(a=a[0]).push(2,0,n),n=0):e===" "||e==="	"||e===`
`||e==="\r"?(m(),n=2):i+=e),n===3&&i==="!--"&&(n=4,a=a[0])}return m(),a}(o)),t),arguments,[])).length>1?t:t[0]}var b=(o,t,...s)=>(t===null&&(t={}),{tag:o,props:t,children:s}),v=N.bind(b);var l=class extends HTMLElement{state={};root=this.attachShadow({mode:"open"});props={};isInited=!1;isEffected=!1;constructor(){super()}async connectedCallback(){for(let t of this.getAttributeNames())this.props[t]=this.getAttribute(t);await this.assign()}async assign(){let t=await this.render(this.props);this.root.innerHTML="",this.root.appendChild(h(t))}init(t){if(!this.isInited){this.isInited=!0;for(let s in t){let e="$"+s;Object.defineProperty(this,e,{get:()=>this.state[e],set:async r=>{this.state[e]=r,await this.assign()}}),this[e]=t[s]}}}async effect(t){this.isEffected||(this.isEffected=!0,await t())}render(){}};g(l,"isClass",!0),g(l,"uniqueName","x-"+Math.random().toString(16).slice(2)+"-"+Math.random().toString(16).slice(2));var d=o=>{let t=class extends l{};return t.prototype.render=o,t};var q=(o,t)=>{for(let s in t)s[0]==="@"?o.addEventListener(s.slice(1),t[s]):o.setAttribute(s,t[s]);return o};function E(o){return o.map(t=>{if(typeof t=="object"){let s;if(Array.isArray(t)){let e=document.createDocumentFragment();if(t.length>=1){let r=E(t);for(let n of r)e.appendChild(n)}return e}else{let e;if(typeof t.tag=="string")s=document.createElement(t.tag);else{if(t.tag.isClass)customElements.get(t.tag.uniqueName)===void 0&&customElements.define(t.tag.uniqueName,t.tag),e=t.tag.uniqueName;else{let r=d(t.tag);customElements.get(r.uniqueName)===void 0&&customElements.define(r.uniqueName,r),e=r.uniqueName}s=document.createElement(e)}}if(s=q(s,t.props),t.children.length>=1){let e=E(t.children);for(let r of e)s.appendChild(r)}return s}else{let s=document.createDocumentFragment();return s.textContent=t,s}})}var h=o=>{let t=document.createDocumentFragment();Array.isArray(o)||(o=[o]);for(let s of E(o))t.appendChild(s);return t};export{v as $,l as TMLElement,d as compact,h as compile,b as tag};
