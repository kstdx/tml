var w=Object.defineProperty;var A=(o,t,e)=>t in o?w(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var u=(o,t,e)=>(A(o,typeof t!="symbol"?t+"":t,e),e),M=(o,t,e)=>{if(!t.has(o))throw TypeError("Cannot "+e)};var h=(o,t,e)=>(M(o,t,"read from private field"),e?e.call(o):t.get(o)),b=(o,t,e)=>{if(t.has(o))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(o):t.set(o,e)};var C=function(o,t,e,s){var r;t[0]=0;for(var n=1;n<t.length;n++){var i=t[n++],m=t[n]?(t[0]|=i?1:2,e[t[n++]]):t[++n];i===3?s[0]=m:i===4?s[1]=Object.assign(s[1]||{},m):i===5?(s[1]=s[1]||{})[t[++n]]=m:i===6?s[1][t[++n]]+=m+"":i?(r=o.apply(m,C(o,m,e,["",null])),s.push(r),m[0]?t[0]|=2:(t[n-2]=0,t[n]=r)):s.push(m)}return s},N=new Map;function j(o){var t=N.get(this);return t||(t=new Map,N.set(this,t)),(t=C(this,t.get(o)||(t.set(o,t=function(e){for(var s,r,n=1,i="",m="",a=[0],f=function(c){n===1&&(c||(i=i.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?a.push(0,c,i):n===3&&(c||i)?(a.push(3,c,i),n=2):n===2&&i==="..."&&c?a.push(4,c,0):n===2&&i&&!c?a.push(5,0,!0,i):n>=5&&((i||!c&&n===5)&&(a.push(n,0,i,r),n=6),c&&(a.push(n,c,0,r),n=6)),i=""},l=0;l<e.length;l++){l&&(n===1&&f(),f(l));for(var d=0;d<e[l].length;d++)s=e[l][d],n===1?s==="<"?(f(),a=[a],n=3):i+=s:n===4?i==="--"&&s===">"?(n=1,i=""):i=s+i[0]:m?s===m?m="":i+=s:s==='"'||s==="'"?m=s:s===">"?(f(),n=1):n&&(s==="="?(n=5,r=i,i=""):s==="/"&&(n<5||e[l][d+1]===">")?(f(),n===3&&(a=a[0]),n=a,(a=a[0]).push(2,0,n),n=0):s===" "||s==="	"||s===`
`||s==="\r"?(f(),n=2):i+=s),n===3&&i==="!--"&&(n=4,a=a[0])}return f(),a}(o)),t),arguments,[])).length>1?t:t[0]}var v=(o,t,...e)=>(t===null&&(t={}),{tag:o,props:t,children:e}),q=j.bind(v);var p,g=class extends HTMLElement{constructor(){super();b(this,p,{});u(this,"state",{});u(this,"root",this.attachShadow({mode:"open"}));u(this,"props",{});u(this,"isInited",!1);u(this,"isEffected",!1)}async connectedCallback(){for(let t of this.getAttributeNames())this.props[t]=this.getAttribute(t);await this.assign()}async assign(){let t=await this.render(this);this.root.innerHTML="",this.root.appendChild(E(t))}init(t){if(!this.isInited){this.isInited=!0;for(let e in t)Object.defineProperty(this.state,e,{get:()=>h(this,p)[e],set:async s=>{h(this,p)[e]=s,await this.assign()}}),h(this,p)[e]=t[e]}}async effect(t){this.isEffected||(this.isEffected=!0,await t())}};p=new WeakMap,u(g,"isClass",!0),u(g,"uniqueName","x-"+Math.random().toString(16).slice(2));var y=o=>{let t=class extends g{};return t.prototype.html=q,t.prototype.render=o,t};var k=(o,t)=>{for(let e in t)e[0]==="@"?o.addEventListener(e.slice(1),t[e]):o.setAttribute(e,t[e]);return o},x=o=>o.map(t=>{if(typeof t=="object"){let e;if(Array.isArray(t)){let s=document.createDocumentFragment();if(t.length>=1){let r=x(t);for(let n of r)s.appendChild(n)}return s}else{let s;if(typeof t.tag=="string")e=document.createElement(t.tag);else{if(t.tag.isClass)customElements.get(t.tag.uniqueName)===void 0&&customElements.define(t.tag.uniqueName,t.tag),s=t.tag.uniqueName;else{let r=y(t.tag);customElements.get(r.uniqueName)===void 0&&customElements.define(r.uniqueName,r),s=r.uniqueName}e=document.createElement(s)}}if(e=k(e,t.props),t.children.length>=1){let s=x(t.children);for(let r of s)e.appendChild(r)}return e}else{let e=document.createDocumentFragment();return e.textContent=t,e}}),E=o=>{let t=document.createDocumentFragment();Array.isArray(o)||(o=[o]);for(let e of x(o))t.appendChild(e);return t};export{g as TMLElement,y as compact,E as compile,v as tag};
