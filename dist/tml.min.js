var j=Object.defineProperty;var v=(o,t,s)=>t in o?j(o,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[t]=s;var g=(o,t,s)=>(v(o,typeof t!="symbol"?t+"":t,s),s);var E=function(o,t,s,e){var r;t[0]=0;for(var n=1;n<t.length;n++){var i=t[n++],m=t[n]?(t[0]|=i?1:2,s[t[n++]]):t[++n];i===3?e[0]=m:i===4?e[1]=Object.assign(e[1]||{},m):i===5?(e[1]=e[1]||{})[t[++n]]=m:i===6?e[1][t[++n]]+=m+"":i?(r=o.apply(m,E(o,m,s,["",null])),e.push(r),m[0]?t[0]|=2:(t[n-2]=0,t[n]=r)):e.push(m)}return e},x=new Map;function N(o){var t=x.get(this);return t||(t=new Map,x.set(this,t)),(t=E(this,t.get(o)||(t.set(o,t=function(s){for(var e,r,n=1,i="",m="",a=[0],u=function(c){n===1&&(c||(i=i.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?a.push(0,c,i):n===3&&(c||i)?(a.push(3,c,i),n=2):n===2&&i==="..."&&c?a.push(4,c,0):n===2&&i&&!c?a.push(5,0,!0,i):n>=5&&((i||!c&&n===5)&&(a.push(n,0,i,r),n=6),c&&(a.push(n,c,0,r),n=6)),i=""},f=0;f<s.length;f++){f&&(n===1&&u(),u(f));for(var p=0;p<s[f].length;p++)e=s[f][p],n===1?e==="<"?(u(),a=[a],n=3):i+=e:n===4?i==="--"&&e===">"?(n=1,i=""):i=e+i[0]:m?e===m?m="":i+=e:e==='"'||e==="'"?m=e:e===">"?(u(),n=1):n&&(e==="="?(n=5,r=i,i=""):e==="/"&&(n<5||s[f][p+1]===">")?(u(),n===3&&(a=a[0]),n=a,(a=a[0]).push(2,0,n),n=0):e===" "||e==="	"||e===`
`||e==="\r"?(u(),n=2):i+=e),n===3&&i==="!--"&&(n=4,a=a[0])}return u(),a}(o)),t),arguments,[])).length>1?t:t[0]}var b=(o,t,...s)=>(t===null&&(t={}),{tag:o,props:t,children:s}),C=N.bind(b);var l=class extends HTMLElement{state={};root=this.attachShadow({mode:"open"});props={};isInited=!1;isEffected=!1;constructor(){super()}async connectedCallback(){for(let t of this.getAttributeNames())this.props[t]=this.getAttribute(t);await this.assign()}async assign(){let t=await this.render(this);this.root.innerHTML="",this.root.appendChild(h(t))}init(t){if(!this.isInited){this.isInited=!0;for(let s in t){let e="$"+s;Object.defineProperty(this,e,{get:()=>this.state[e],set:async r=>{this.state[e]=r,await this.assign()}}),this[e]=t[s]}}}async effect(t){this.isEffected||(this.isEffected=!0,await t())}};g(l,"isClass",!0),g(l,"uniqueName","x-"+Math.random().toString(16).slice(2));var d=o=>{let t=class extends l{};return t.prototype.html=C,t.prototype.render=o,t};var q=(o,t)=>{for(let s in t)s[0]==="@"?o.addEventListener(s.slice(1),t[s]):o.setAttribute(s,t[s]);return o},y=o=>o.map(t=>{if(typeof t=="object"){let s;if(Array.isArray(t)){let e=document.createDocumentFragment();if(t.length>=1){let r=y(t);for(let n of r)e.appendChild(n)}return e}else{let e;if(typeof t.tag=="string")s=document.createElement(t.tag);else{if(t.tag.isClass)customElements.get(t.tag.uniqueName)===void 0&&customElements.define(t.tag.uniqueName,t.tag),e=t.tag.uniqueName;else{let r=d(t.tag);customElements.get(r.uniqueName)===void 0&&customElements.define(r.uniqueName,r),e=r.uniqueName}s=document.createElement(e)}}if(s=q(s,t.props),t.children.length>=1){let e=y(t.children);for(let r of e)s.appendChild(r)}return s}else{let s=document.createDocumentFragment();return s.textContent=t,s}}),h=o=>{let t=document.createDocumentFragment();Array.isArray(o)||(o=[o]);for(let s of y(o))t.appendChild(s);return t};export{l as TMLElement,d as compact,h as compile,b as tag};
